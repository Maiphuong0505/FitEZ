<div class="card my-4 shadow-sm border-0 rounded-3 hover-shadow card-fixed-height bg-white" data-controller="display-toggle form-toggle-display">
  <div class="row g-0 h-100 align-items-center">
    <div class="col-12 col-md-4 h-100">
      <div class="image-container h-100 d-flex justify-content-center align-item-center">
        <% if plan.workout_sessions.any? %>
          <% sessions_with_exercises = plan.workout_sessions.select { |s| s.session_exercises.any? } %>
          <% unless sessions_with_exercises.empty? %>
            <% chosen_session =  sessions_with_exercises.sample%>
            <%= cl_image_tag(chosen_session.session_exercises.sample.exercise.photo.key,
                  class: "img-fluid bg-white",
                  style: "max-height: 180px; object-fit: contain;") %>
          <% else %>
            <i class="fa-solid fa-dumbbell text-danger" style="font-size:156px;"></i>
          <% end %>
        <% else %>
          <i class="fa-solid fa-dumbbell text-danger" style="font-size:156px;"></i>
        <% end %>
      </div>
    </div>
    <div class="col-md-8 h-100">
      <div class="card-body p-4">
        <div class="d-flex justify-content-between align-items-start mb-3">
          <div class="plan-info">
            <h3 class="card-title fw-bold text-dark mb-1 fs-4">
              <span class="fs-5">From</span> <%= plan.starting_date %> <span class="fs-5">to</span> <%= plan.ending_date %>
            </h3>
            <div class="d-flex justify-content-center">
              <% if plan.workout_sessions.any? %>
                <button type="button" class="btn btn-outline-warning my-4 rounded-pill px-3 py-2 me-2 fw-bold fs-5" data-action="click->display-toggle#fire">
                  <i class="fa-solid fa-medal"></i> <%= plan.workout_sessions.count %> sessions
                </button>
              <% else %>
                <h5 class="text-muted my-4 badge rounded-pill px-3 py-2 me-2 border bg-white text-dark fw-normal fs-5"><i class="fa-solid fa-face-grimace"></i> 0 sessions</h5>
              <% end %>
              <div class="add-session-button py-2 my-4 mx-2">
                <button type="button" class="btn btn-outline-warning rounded-4" data-action="click->form-toggle-display#fire"><i class="fa-solid fa-calendar-plus"></i></button>
              </div>
            </div>
          </div>
          <%# Div for add a session button %>
        </div>
      </div>
    </div>
  </div>
  <div data-display-toggle-target="togglableElement" class="session-display d-none">
    <% if plan.workout_sessions.any? %>
      <% plan.workout_sessions.each do |session| %>
        <%= render 'clients/workout_session_display', session: session%>
      <% end %>
    <% end %>
  </div>
  <%# Div for session-adding form %>
  <div data-form-toggle-display-target="togglableForm" class="add-session-form row g-0 h-100 my-3 px-3 d-none">
    <%= render 'workout_sessions/workout_session_form', workout_session: workout_session, workout_plan: plan %>
  </div>
</div>
